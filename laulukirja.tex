\documentclass[9pt]{extbook}

\usepackage[a6paper, portrait, outer=0.5cm, inner=1.5cm, tmargin=1.7cm, bmargin=1.5cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{verse}
\usepackage{imakeidx}
\usepackage{expl3}
\usepackage{calc} % widthof
\usepackage{tabto}
\usepackage{titlesec}
\usepackage{fancyhdr} % headers
\usepackage{etoolbox} % verse raggedright
\usepackage[official]{eurosym} % euro character
\usepackage{wasysym} % note character

% fix index indent on linewrap
% set raggedright in index
\usepackage[justific=raggedright,indentunit=0.2cm]{idxlayout} 

\AtBeginEnvironment{verse}{\raggedright}

% indent on newline
\setlength{\vindent}{0.5cm}

% header configuration
\pagestyle{fancy}
\renewcommand{\sectionmark}[1]{\markright{#1}}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt} % optional: removes header line
\fancyhead[LE,RO]{\rightmark}
\fancyfoot[LE,RO]{\thepage}

\makeindex[title=Hakemisto,intoc,columns=2]

\makeatletter
\def\@hspace#1{\begingroup\setlength\dimen@{#1}\hskip\dimen@\endgroup}
\makeatother

{\makeatletter\gdef\reallynopagebreak{\par\nopagebreak\@nobreaktrue}}

%\DeclareUnicodeCharacter{00A0}{~}

\begin{document}
\raggedbottom

\small
\input{laulut.tex}

\printindex

\end{document}
